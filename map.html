<!DOCTYPE html><!-- Last Published: Mon May 19 2025 19:39:49 GMT+0000 (Coordinated Universal Time) --><html data-wf-domain="berizaryad.ru" data-wf-page="62f2964b33f545da6b2a7b3c" data-wf-site="61b8503a61bec0aeed9a9f48" lang="ru"><head><meta charset="utf-8"/><title>Карта зарядных станций • Бери заряд</title><meta content="Поможем найти нужную станцию на карте вашего города. Введите адрес, чтобы найти автомат в Москве, Спб, Казани, Сочи, Екатеринбург и других городах России" name="description"/><meta content="Карта зарядных станций • Бери заряд" property="og:title"/><meta content="Поможем найти нужную станцию на карте вашего города. Введите адрес, чтобы найти автомат в Москве, Спб, Казани, Сочи, Екатеринбург и других городах России" property="og:description"/><meta content="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61fe5f3bfd7ce62a48e1ded0_og--map.jpg" property="og:image"/><meta content="Карта зарядных станций • Бери заряд" property="twitter:title"/><meta content="Поможем найти нужную станцию на карте вашего города. Введите адрес, чтобы найти автомат в Москве, Спб, Казани, Сочи, Екатеринбург и других городах России" property="twitter:description"/><meta content="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61fe5f3bfd7ce62a48e1ded0_og--map.jpg" property="twitter:image"/><meta property="og:type" content="website"/><meta content="summary_large_image" name="twitter:card"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link href="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/css/beri-zaryad.webflow.shared.089027a4f.min.css" rel="stylesheet" type="text/css"/><script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script><link href="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61fd57dff1a700438340dcb0_Frame%20513448%402x.png" rel="shortcut icon" type="image/x-icon"/><link href="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61fd57e256575828d4f7df24_Frame%20513448.png" rel="apple-touch-icon"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-HQS7DR0MFR"></script><script type="text/javascript">window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-HQS7DR0MFR', {'anonymize_ip': false, 'optimize_id': 'OPT-PKQRLSP'});</script><script>window.CP_PID = "pk_abec032be35f366714b6b19d1592e";</script>

<script async src="https://www.googleoptimize.com/optimize.js?id=OPT-PKQRLSP"></script>



<style>
  .slider {
    cursor: grab !important;
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
  .slider::-webkit-scrollbar {
    display: none;
    width: 0 !important;
    height: 0 !important;
    -webkit-appearance: none !important;
    background: transparent !important;
  }
  .slider__item { pointer-events: auto; }
  .is-dragging { cursor: grabbing !important; }
  .filled-input{
    border-color: #A3ACC1;
    color: black;
  } 
  
  .w-webflow-badge { display: none !important; }
</style>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<!-- Scripts from https://webflow-plugins.webflow.io -->
<script async src="https://scripts.5x10.co/files/webflow/build/marquee.js" type="text/javascript"></script>
<script async src="https://scripts.5x10.co/files/webflow/build/observer.js" type="text/javascript"></script>
<script async src="https://scripts.5x10.co/files/webflow/build/swiper.js" type="text/javascript"></script>
<script type="text/javascript">/* Slider */function Slider(e,t){if(!e)return;var s,n,r,i,a,l=!1,o=0,c=0;function f(){cancelAnimationFrame(a)}function u(){e.scrollLeft+=o,o*=.96,Math.abs(o)>.5&&(a=requestAnimationFrame(u))}e.querySelectorAll("img,a").forEach(function(e){e.ondragstart=function(e){return e.preventDefault(),!1}}),e.addEventListener("mousedown",t=>{l=!0,s=t.pageX-e.offsetLeft,n=e.scrollLeft,f(),i=!0,r=setTimeout(function(){i=!1,e.classList.add("is-dragging"),f()},150)}),e.addEventListener("mouseleave",()=>{l=!1,e.classList.remove("is-dragging")}),e.addEventListener("mouseup",t=>{l=!1,e.classList.remove("is-dragging"),f(),a=requestAnimationFrame(u),i&&r&&(clearInterval(r),r=null,i=!1)},!1),e.addEventListener("mousemove",t=>{if(!l)return;t.preventDefault(),e.classList.contains("is-dragging")||e.classList.add("is-dragging");const r=1*(t.pageX-e.offsetLeft-s);var i=e.scrollLeft;e.scrollLeft=n-r,o=e.scrollLeft-i}),e.addEventListener("scroll",function(){t&&c!==e.scrollLeft&&(c=e.scrollLeft,e.setAttribute("scroll-x",c),t(c))}),e.setAttribute("scroll-x",0)}</script>
<script async src="https://cdn.splitbee.io/sb.js"></script><style>
	.map-info { display: none; }
  input[disabled] { background-color: transparent !important; }
  .clusters { display: none; }
</style>

</head><body><div class="html-embed w-embed"><style>
  :root, body {
   font-size: clamp(16px, 2.02vw, 20px) !important;
  }
  
  .menu-btn.w--open .close-icon {
    display: block !important;
   }
  .menu-btn.w--open .burger-icon {
    display: none !important;
   }
   .logo-row, .logo-row-block{
   	mix-blend-mode: luminosity !important;
   }
   .teg-block {
   	scrollbar-width: none;
   }
  .cidebar-city.active .sity-counter {
  	color: #fff;
  }
  .cidebar-city.active .sity-arrow {
  	display: block;
  }
  
 @media screen and (min-width: 1280px)  {
    :root, body {
     	font-size: clamp(30px, 2.34vw, 48px) !important;
    	}
    } 
    
  @media screen and (max-width: 767px) {
    .card-block::-webkit-scrollbar {
      display: none;
      width: 0 !important;
      height: 0 !important;
      -webkit-appearance: none !important;
      background: transparent !important;
  	}
    .advantages::-webkit-scrollbar {
      display: none;
      width: 0 !important;
      height: 0 !important;
      -webkit-appearance: none !important;
      background: transparent !important;
  	}
   }
</style></div><div data-animation="default" data-collapse="medium" data-duration="0" data-easing="ease-out" data-easing2="ease-in" role="banner" class="navbar w-nav"><div class="fonts-accurate-rendering w-embed"><style> 

* {
    -moz-osx-font-smoothing: grayscale;
    text-decoration:none;
    text-transform:none!important;
    -webkit-line-break: after-white-space;
    text-rendering: optimizelegibility;
    -webkit-font-smoothing: antialiased;
}

/* Fallback for browsers that don't support scrollbar-gutter */
html {
  overflow-y: scroll;
}

/* scrollbar-gutter FTW! */
@supports (scrollbar-gutter: stable) {
  html {
    overflow-y: auto;
    scrollbar-gutter: stable;
  }
}

</style></div><div class="container-nav"><a href="index.html" data-splitbee-event="nav-menu-home-logo" class="nav-brand w-nav-brand"><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/67bd9eada8ac6441e5075d2a_Link%2BBackgroundColor%20(16).png" loading="lazy" width="150" sizes="150px" alt="" srcset="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/67bd9eada8ac6441e5075d2a_Link%2BBackgroundColor%20(16)-p-500.png 500w, https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/67bd9eada8ac6441e5075d2a_Link%2BBackgroundColor%20(16).png 887w" class="nav-logo"/></a><nav role="navigation" class="nav-menu w-nav-menu"><div class="nav-inner"><div class="nav-link-row"><div data-hover="false" data-delay="0" data-w-id="6e6db001-f7ae-c3d7-e0e4-7dc8fa653d46" class="dropdown w-dropdown"><div data-splitbee-event="nav-menu-business" class="toggle w-dropdown-toggle"><div class="text-block-9">Для бизнеса</div></div><nav class="drop-list w-dropdown-list"><a data-splitbee-event="nav-menu-business-place-stations" href="business/place-stations.html" class="drop-link-block w-inline-block"><div><div class="drop-link-text">Разместить у себя</div><div class="drop-link-text gray">Зарядные станции в твоём заведении</div></div><img loading="lazy" src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61b9e80e7b631762400e3206_head%20drop%20arrow.svg" alt="" class="drop-arrow"/></a><a data-splitbee-event="nav-menu-business-partners" href="business/partners.html" class="drop-link-block w-inline-block"><div><div class="drop-link-text">Инвестиции и франшиза</div><div class="drop-link-text gray">Зарабатывай вместе с нами</div></div><img loading="lazy" src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61b9e80e7b631762400e3206_head%20drop%20arrow.svg" alt="" class="drop-arrow"/></a><a data-splitbee-event="nav-menu-business-products" href="business/products.html" class="drop-link-block w-inline-block"><div><div class="drop-link-text">Подробнее про оборудование</div><div class="drop-link-text gray">Пауэрбанки и зарядные станции</div></div><img loading="lazy" src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61b9e80e7b631762400e3206_head%20drop%20arrow.svg" alt="" class="drop-arrow"/></a></nav></div><a data-splitbee-event="nav-menu-pricing" href="events.html" class="nav-link w-inline-block"><div class="nav-link-text">Для мероприятий</div><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61b9e80e7b631762400e3206_head%20drop%20arrow.svg" loading="lazy" alt="" class="header-drop-arrow hidden"/></a><a data-splitbee-event="nav-menu-pricing" href="pricing.html" class="nav-link w-inline-block"><div class="nav-link-text">Тарифы</div><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61b9e80e7b631762400e3206_head%20drop%20arrow.svg" loading="lazy" alt="" class="header-drop-arrow hidden"/></a><a data-splitbee-event="nav-menu-about-us" href="about-us.html" class="nav-link w-inline-block"><div class="nav-link-text">О нас</div><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61b9e80e7b631762400e3206_head%20drop%20arrow.svg" loading="lazy" alt="" class="header-drop-arrow hidden"/></a><a data-splitbee-event="nav-menu-map" href="map.html" aria-current="page" class="nav-link w-inline-block w--current"><div class="nav-link-text">Карта станций</div><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61b9e80e7b631762400e3206_head%20drop%20arrow.svg" loading="lazy" alt="" class="header-drop-arrow hidden"/></a><a data-splitbee-event="nav-menu-map" href="press-centr/news.html" class="nav-link w-inline-block"><div class="nav-link-text">Пресс-центр</div><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61b9e80e7b631762400e3206_head%20drop%20arrow.svg" loading="lazy" alt="" class="header-drop-arrow hidden"/></a></div><a data-splitbee-event="nav-menu-contact-us" href="contact-us.html" class="nav-link last w-inline-block"><div class="nav-link-text">Контакты и поддержка</div><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61b9a1a9d7bd408a4872c15d_arrow%20icon.svg" loading="lazy" alt="" class="header-drop-arrow mob-hidden"/><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61b9e80e7b631762400e3206_head%20drop%20arrow.svg" loading="lazy" alt="" class="header-drop-arrow hidden"/></a><div class="contact-mob-wrap"><a href="https://redirect.appmetrica.yandex.com/serve/27803249700509978?utm_source=site_am&amp;utm_medium=site_am" target="_blank" class="nav-link desctop-hidden w-inline-block"><div class="nav-link-text">Установить приложение</div><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61b9e80e7b631762400e3206_head%20drop%20arrow.svg" loading="lazy" alt="" class="header-drop-arrow hidden"/></a><div class="contact-mob-block"><a data-splitbee-event="nav-menu-mobile-phone" href="tel:+78005550496" class="mob-phone w-inline-block"><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61c03f24200290149f96c1f9_arrow%20icon%20blue.svg" loading="lazy" alt="" class="phone-icon"/><div class="contact-phone">8 800 555-04-96</div></a><div class="contact-link-block"><a data-splitbee-event="nav-menu-mobile-telegram" href="https://t.me/Beri_Zaryad_bot" target="_blank" class="contact-link">Telegram -&gt;</a></div></div></div></div></nav><div class="menu-btn w-nav-button"><div class="menu-btn-inner"><div class="menu-btn-text">Меню</div><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61c042ddb4e712a8ebf8262e_close%20icon.svg" loading="lazy" alt="" class="close-icon"/><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61c044a804d338b860c630d2_burger%20icon.svg" loading="lazy" alt="" class="burger-icon"/></div></div></div></div><div class="map-section"><div class="map-block"><form action="https://berizaryad.ru/search" class="map-search w-form"><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61cb02dd55dce2224395bedb_Search.svg" loading="lazy" alt="" class="map-search-icon"/><input class="map-search-input w-input" maxlength="256" name="query" placeholder="Поиск по адресу" type="search" id="search-2" required=""/><input type="submit" class="search-button-2 w-button" value="Search"/></form><div class="map-info"><div class="clusters"><a href="map.html#" class="cluster-item active w-inline-block"><div class="cluster-ico w-embed"><svg width="100%" viewBox="0 0 36 36" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <defs><linearGradient x1="0%" y1="50%" x2="106.944%" y2="50%" id="a"><stop stop-color="#00ACFF" offset="0%"/><stop stop-color="#019FEB" offset="100%"/></linearGradient></defs>
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
      <circle fill="url(#a)" fill-rule="nonzero" cx="18" cy="18" r="18"/>
      <circle stroke="#FFF" stroke-width="4" cx="18" cy="18" r="16"/>
      <path d="M22.93 16.007l-4.862-.028a.386.386 0 0 1-.396-.396l.029-5.174c0-.424-.566-.565-.764-.198l-4.89 9.188a.405.405 0 0 0 .367.594l4.863.028c.226 0 .395.17.395.396l-.028 5.174c0 .424.566.565.764.198l4.89-9.217c.142-.254-.056-.565-.367-.565z" fill="#FFDF38" fill-rule="nonzero"/>
    </g>
  </svg></div></a><a href="map.html#" class="cluster-item w-inline-block"><div class="cluster-ico w-embed"><svg width="100%" viewBox="0 0 36 36" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <defs><linearGradient x1="0%" y1="50%" x2="106.944%" y2="50%" id="a"><stop stop-color="#00ACFF" offset="0%"/><stop stop-color="#019FEB" offset="100%"/></linearGradient></defs>
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
      <circle fill="url(#a)" fill-rule="nonzero" cx="18" cy="18" r="18"/>
      <circle stroke="#FFF" stroke-width="4" cx="18" cy="18" r="16"/>
      <path d="M22.93 16.007l-4.862-.028a.386.386 0 0 1-.396-.396l.029-5.174c0-.424-.566-.565-.764-.198l-4.89 9.188a.405.405 0 0 0 .367.594l4.863.028c.226 0 .395.17.395.396l-.028 5.174c0 .424.566.565.764.198l4.89-9.217c.142-.254-.056-.565-.367-.565z" fill="#FFDF38" fill-rule="nonzero"/>
    </g>
  </svg></div></a></div><div class="map-info-head"><div class="head-item"><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61cb0cc04bb27e67f3364143_poverbank%20icon%20active.svg" loading="lazy" alt="" class="poverbank-icon"/><div class="text-block"><div class="text-gray">Можно взять</div><div powerbank="take" class="text-darck">3 пауэрбанка</div></div></div><div class="head-item last"><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61cb0cc0150c4574ceb9ee38_poverbank%20icon.svg" loading="lazy" alt="" class="poverbank-icon"/><div class="text-block"><div class="text-gray">Можно сдать</div><div powerbank="cells" class="text-darck">5 пауэрбанков</div></div></div></div><div class="map-info-inner"><div powerbank="address" class="map-info-row"><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61cb0f3e8b35d019a6f8812e_map%20marker.svg" loading="lazy" alt="" class="map-info-icon"/><div class="map-info-text">г Москва, ш Дмитровское, д 13А, павильон №7 Союзмультипарк</div></div><div powerbank="work-time" class="map-info-row"><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61cb0f3e9a14f62522e274e7_Clock.svg" loading="lazy" alt="" class="map-info-icon"/><div class="map-info-text">Открыто до 21:00</div></div><div powerbank="price" class="map-info-row"><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61cb0f3ef16cb02990aecd0f_Dollar.svg" loading="lazy" alt="" class="map-info-icon"/><div class="map-info-text">30 минут бесплатно, потом 100 р/сутки</div></div></div><a data-w-id="19f7cc8f-5aeb-39ad-e320-da6e1b5cfb59" href="map.html#" class="map-info-bottom-pc w-inline-block"><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61cb1090150c45b6c0ba1494_apple%20elips%20icon.svg" loading="lazy" alt="" class="map-info-img"/><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61cb10904ee6666a47e80f1c_googl%20play%20icon.svg" loading="lazy" alt="" class="map-info-img"/><div class="map-info-txt">Арендовать здесь</div></a><a href="https://berizaryad.page.link/GJGh" target="_blank" class="map-info-bottom mobile w-inline-block"><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61cb1090150c45b6c0ba1494_apple%20elips%20icon.svg" loading="lazy" alt="" class="map-info-img"/><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61cb10904ee6666a47e80f1c_googl%20play%20icon.svg" loading="lazy" alt="" class="map-info-img"/><div class="map-info-txt">Арендовать здесь</div></a></div><div class="map"></div></div><div class="map-loading"><div class="map-loading-text">Загрузка карты…</div></div></div><div class="modal-wrap"><div data-w-id="467092dc-d8d9-9994-7384-356cdb5cf53f" class="popup-header"><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61cb1531448805702ddf928f_close%20icon.svg" loading="lazy" alt="" class="popup-close-icon"/></div><div data-w-id="467092dc-d8d9-9994-7384-356cdb5cf541" class="section modal-sect"><div class="container-1344 blue"><div class="image-wrap mob"><div class="qrdivblock"><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/67bd9a27eea590c18191e48a_QR2%20(1).png" loading="lazy" width="265" alt="" class="qr-image"/></div><div class="mobile-block modal"><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/62051fd81197fcd616c818d1_%D1%81%D0%BA%D1%80%D0%B8%D0%BD%D1%88%D0%BE%D1%82.webp" loading="eager" alt="" class="screenshot modal"/><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/67bc8070b421b7feff97400a_Image.png" loading="eager" sizes="(max-width: 767px) 100vw, 554.0017700195312px" srcset="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/67bc8070b421b7feff97400a_Image-p-500.png 500w, https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/67bc8070b421b7feff97400a_Image.png 554w" alt="" class="mobail-bg"/></div><div class="text-column popup"><img src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/61b9a1ab30e898840104521d_OK%20icon.svg" loading="lazy" alt="" class="text-column-icon hidden"/><h2 class="text-column-heading mob white-centre">Загрузи приложение. Просто наведи камеру на QR-код.</h2><a href="map.html#" class="button-mob-white w-inline-block"><div>Установить приложение -&gt;</div></a></div></div></div></div><div class="modal-dark-close-area"></div><div class="modal-dark-close-area right"></div></div><script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=61b8503a61bec0aeed9a9f48" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script><script src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/js/webflow.schunk.57d5559d2f0cd9f8.js" type="text/javascript"></script><script src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/js/webflow.schunk.ac118049c0da651d.js" type="text/javascript"></script><script src="https://cdn.prod.website-files.com/61b8503a61bec0aeed9a9f48/js/webflow.eda7c62e.cb116cf63b24d18e.js" type="text/javascript"></script><script src="https://cdn.jsdelivr.net/npm/jquery.maskedinput@latest/src/jquery.maskedinput.min.js" type="text/javascript"></script>
<script>
  var Webflow = Webflow||[];
  Webflow.push(function(){
    $('.other-city-field').css({display: 'none' });
    $('.select-city').on('change', function (e) {
      var selected = $(this).find("option:selected").val();
      var otherCity = ["другой город", "московская область"].includes(selected.toLowerCase());
      $('.other-city-field').css({display: otherCity ? 'block' : 'none' });
      $('.other-city-field').prop('required', otherCity ? true : false);
    });
  });
</script>

<script>
  var Webflow = Webflow || []; 
  Webflow.push(function() { 
    $('input[type="tel"]').mask("+7 (999) 999-99-99"); 
  });
</script>

<script type="text/javascript">
  (function(){
    const searchParams = new URLSearchParams(window.location.search)
    for(let [name, value] of searchParams) {
      if(name.startsWith("utm_")) {
        document.querySelectorAll("form").forEach(form => {
          const input = document.createElement('input');
          input.setAttribute("type", "hidden");
          input.setAttribute("name", name);
          input.setAttribute("value", value);
          form.appendChild(input)
        });
      } 
    }
  })();
</script><script type="text/javascript">
(async () => {
  // https://beri-zaryad.webflow.io/map
  let mapEl;
  let mapState;
  if (document.readyState == 'loading') { document.addEventListener('DOMContentLoaded', () => { setLoadState(); }); } else { setLoadState(); }
  function setLoadState() { document.querySelector('.map-search-input').disabled = true; }
  await (async () => {   
    return new Promise((resolve, reject) => {
      function load() {
        const YM = "9ce23deb-314a-4437-a575-4d1f879e45fe";
        const script = document.createElement('script');
        script.src = `https://api-maps.yandex.ru/2.1/?apikey=${YM}&lang=ru_RU`;
        script.type = "text/javascript";
        script.onload = () => { ymaps.ready(() => { 
          mapEl = document.querySelector('.map');
          ymaps.geolocation.get().then(function (res) {
            const bounds = res.geoObjects.get(0).properties.get('boundedBy');
            mapState = ymaps.util.bounds.getCenterAndZoom( bounds, [mapEl.offsetWidth, mapEl.offsetHeight]);
            document.querySelector('.map-search-input').disabled = false;
            document.querySelector('.map-loading').remove();
            resolve(); 
          }, function (e) {
            console.log(e);
            resolve(); 
          })
        }); };
        document.body.appendChild(script);
      }
      if (document.readyState == 'loading') { document.addEventListener('DOMContentLoaded', () => { load(); }); } else { load(); }
    });
  })();

  let locations = sessionStorage.getItem("locations");
  try {
    if(locations) {
      locations = JSON.parse(locations);
    } else { 
      const res = await fetch("https://api.berizaryad.ru/locations");
      const json = await res.json();
      locations = json.data.filter(
        item => item?.attributes?.address !== null || 
        item?.attributes?.address?.trim().length > 0 
      );
      sessionStorage.setItem("locations", JSON.stringify(locations));
    }  
  } catch(e) {}

  /* Всё загружено теперь и карта и все точки для карты */

  // if(!mapState) {
    mapState = {
      center: [55.76, 37.64],
      zoom: 12,
    }
  // }
  const mapInfo = document.querySelector('.map-info');

  const map = new ymaps.Map(mapEl, {
    ...mapState,
    controls: ['zoomControl'],
  });

  map.events.add(['mousedown'], function (e) {
    mapInfo.style.display = "none";
  });

  // поиск по карте
  const searchEl = document.querySelector('.map-search-input');
  document.querySelector('.map-search').removeAttribute("action");
  document.querySelector('.map-search').addEventListener("submit", async (e) => { 
    e.preventDefault(); 
    searchMap(searchEl.value);
    return false;
  });

	function searchMap(value) {
    ymaps.geocode(value, {results: 1 }).then(function (res) {            
      var firstGeoObject = res.geoObjects.get(0),
      bounds = firstGeoObject.properties.get('boundedBy');
      map.setBounds(bounds, { checkZoomRange: true });
    });
  }

  // менеджер объектов
  const collection = {
    type: "FeatureCollection",
    features: await locations.map(item => {
        const { latitude, longitude, id }  = item.attributes;
        return {
          type: "Feature",
          id: id,
          geometry: {
            type: "Point",
            coordinates: [latitude, longitude]
          }
        }
      })
  }

  objectManager = new ymaps.ObjectManager({ 
    clusterize: true,
    clusterOpenBalloonOnClick: false
  });

  objectManager.add(collection);

  function declOfNum(num, titles) {
    // склонение числительных, например num комнат = 1, 2 или 5 --> declOfNum(count, [" комната", " комнаты", " комнат"]);
    return titles[(num % 10 === 1 && num % 100 !== 11) ? 0 : num % 10 >= 2 && num % 10 <= 4 && (num % 100 < 10 || num % 100 >= 20) ? 1 : 2]
  }

  function setTime(date, timeStr, tomorrow = false) {
    const time = timeStr.split(":").map(i => parseInt(i));
    date.setHours(time[0] || 0);
    date.setMinutes(time[1] || 0);
    date.setSeconds(time[2] || 0);
    date.setMilliseconds(time[3] || 0);
    if(tomorrow === true) {
      const tmrw = new Date(date);
      tmrw.setDate(tmrw.getDate() + 1);
      return tmrw;
    }
    return date;
  }

  const clusters = document.querySelector('.clusters');

  function showPlaceInfo(place) {
  	console.log(place);
  
    const attributes = place.attributes;

    const numCharged = parseInt(attributes["num-charged-chargers"]);
    mapInfo.querySelector('[powerbank="take"]').textContent = `${numCharged} ${declOfNum(numCharged, ["пауэрбанк", "пауэрбанка", "пауэрбанков"])}`;

    const numEmpty = parseInt(attributes["num-empty-cells"]);
    mapInfo.querySelector('[powerbank="cells"]').textContent = `${numEmpty} ${declOfNum(numEmpty, ["пауэрбанк", "пауэрбанка", "пауэрбанков"])}`;
    
    mapInfo.querySelector('[powerbank="address"] .map-info-text').innerHTML = `<div style="font-weight: bold;">${attributes.description}</div>${attributes.address}`;

    mapInfo.querySelector('[powerbank="price"]').style.display = "none";


    const workingTime = place.attributes["working-time"];
    const now = new Date();
		
    const day = now.getDay();
		const todayWorkingTime = workingTime[day];


		const openTime = setTime(new Date(), todayWorkingTime["open-at"]);
    const closeTime = setTime(new Date(), todayWorkingTime["close-at"]);

    const close = `Открыто до ${todayWorkingTime["close-at"]}`;
    const open = `Откроется в ${todayWorkingTime["open-at"]}`;
    const tomorrowOpen = `Откроется в ${todayWorkingTime["tomorrow-open-at"]}`;
    
    let openHours;
    
    if(now < openTime) {
      openHours = open;
    } else if(now >= openTime && now <= closeTime) {
      openHours = close;
    } else if(now > closeTime) {
      openHours = tomorrowOpen;
    }

    mapInfo.querySelector('[powerbank="work-time"] .map-info-text').textContent = openHours;

    mapInfo.style.display = "block";
  }

  function onObjectEvent (e) {
    const id = e.get('objectId');
    const objectGeometry = objectManager.objects.getById(id).geometry.type;
    if (objectGeometry === 'Point') {
      const place = locations.find(loc => loc.attributes.id === id);
      showPlaceInfo(place);
      clusters.style.display = "none";
    }
  }
  objectManager.objects.events.add(['click'], onObjectEvent);
  
  const clusterItemTemplate = document.querySelector('.cluster-item.active').cloneNode(true);
  clusterItemTemplate.classList.remove('active');

  function changeClusterItem(event) {
    const id = this.getAttribute("cluster-place-id");
    const place = locations.find(loc => loc.attributes.id === parseInt(id));
    document.querySelectorAll('[cluster-place-id].active').forEach(el => el.classList.remove("active"));
    this.classList.add("active");
    showPlaceInfo(place);
  }

  function onClusterEvent (e) {
    const zoom = map.getZoom();
    if(zoom === 21) {
      e.preventDefault();
      var clusterId = e.get('objectId');
      var cluster = objectManager.clusters.getById(clusterId);
      var clusterFeatures = cluster.features;

      document.querySelectorAll('[cluster-place-id]').forEach(el => el.removeEventListener('click', changeClusterItem));
      clusters.innerHTML = "";

      clusterFeatures.forEach((item, index) => {
        const place = locations.find(loc => loc.attributes.id === item.id);
        const clusterItem = clusterItemTemplate.cloneNode(true);
        clusterItem.setAttribute("cluster-place-id", item.id);
        if(index === 0) {
          showPlaceInfo(place);
          clusterItem.classList.add("active");
        }
        clusters.appendChild(clusterItem);
        clusterItem.addEventListener('click', changeClusterItem);
      });
      clusters.style.display = "flex";

    }
  }
  objectManager.clusters.events.add(['click'], onClusterEvent);


  const svgPin = `<svg width="36" height="36" viewBox="0 0 36 36" version="1.1" xmlns="http://www.w3.org/2000/svg">
    <defs><linearGradient x1="0%" y1="50%" x2="106.944%" y2="50%" id="a"><stop stop-color="#00ACFF" offset="0%"/><stop stop-color="#019FEB" offset="100%"/></linearGradient></defs>
    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
      <circle fill="url(#a)" fill-rule="nonzero" cx="18" cy="18" r="18"/>
      <circle stroke="#FFF" stroke-width="4" cx="18" cy="18" r="16"/>
      <path d="M22.93 16.007l-4.862-.028a.386.386 0 0 1-.396-.396l.029-5.174c0-.424-.566-.565-.764-.198l-4.89 9.188a.405.405 0 0 0 .367.594l4.863.028c.226 0 .395.17.395.396l-.028 5.174c0 .424.566.565.764.198l4.89-9.217c.142-.254-.056-.565-.367-.565z" fill="#FFDF38" fill-rule="nonzero"/>
    </g>
  </svg>`;

  objectManager.objects.options.set({
    iconLayout: 'default#image',
    iconImageHref: 'data:image/svg+xml;charset=UTF-8;base64,' + btoa(svgPin),
    iconImageSize: [44, 44],
    iconImageOffset: [-22, -22]
  })

  map.geoObjects.add(objectManager);

  var suggestView = new ymaps.SuggestView(searchEl, {
    provider: 'yandex#map',
    results: 3
  });

  suggestView.events.add("select", (e) => searchMap(e.get('item').value));
  window.addEventListener("resize", () => {
    map.container.fitToViewport()
  });

  const style = document.createElement("style");
  style.innerText = `
    .map-search [data-index] {
      font-family: "Maisonneue book", sans-serif;
      font-size: 0.75rem;
      padding: 0.25rem 0.5rem
    }
    .map-search [data-index]:hover, .map-search [data-index]:hover > * {
      background-color: #364b7d !important;
      color: #fff;
    }
  `;
  document.head.appendChild(style);

})();
</script></body></html>